<% unless db_obj.normative_rules.empty? -%>
<% nice_name = db_obj.is_a?(Udb::CsrField) ? "#{db_obj.parent.name}.#{db_obj.name}" : db_obj.name -%>
<%   if defined?(use_description_list) && use_description_list -%>
Normative Rules for `<%= nice_name %>`: ::
<%   else -%>
==== Normative Rules for `<%= nice_name %>`
<%   end -%>

<%   if normative_rule_tags.tags_available? -%>
[cols="8%,10%,10%,7%,5%,60%"]
|===
| Name | Coverage Points | Description | Doc | Chap | Links/Excerpts

<%     db_obj.normative_rules.each do |nr| -%>
<%     num_doc_links = nr.doc_links.length -%>
<%     row_span = (num_doc_links > 0) ? ".#{num_doc_links}+" : "" -%>
<%     desc_col_span = (num_doc_links == 0) ? "4+" : "" -%>
<%= "#{row_span}" %>| <%= defined?(fmt) ? anchor_for_udb_doc_norm_rule(fmt, nr.name) : "" %><%= nr.name %>
<% cp_names = [] -%>
<% nr.coverage_point_names.each do |cp_name| -%>
<%   cp_names << (defined?(fmt) ? link_to_udb_doc_cover_pt(fmt, cp_name) : cp_name) -%>
<% end -%>
<%= "#{row_span}| #{cp_names.join(',')}" %>
<%= "#{desc_col_span}#{row_span}" %>a| <%= nr.description %>
<%       if nr.doc_links.empty? -%>
|
|
|
<%       else # some doc_links -%>
<%         some_not_found = false -%>
<%         nr.doc_links.each do |doc_link| -%>
| <%= doc_link.to_doc_name(normative_rule_tags) %>
| <%= doc_link.to_section(normative_rule_tags) %>
a| <%= doc_link.to_excerpt(normative_rule_tags) %>
<%           if doc_link.missing_normative_rule_tag?(normative_rule_tags) then -%>
<%             warn "Error: Normative rule tag #{doc_link.link_name} for #{db_obj.kind} '#{nice_name}' missing from standards documentation" -%>
<%             some_not_found = true -%>
<%           end # missing -%>
<%         end # each doc_link -%>
<%         raise "Exiting due to one or more normative rule tags not found" if some_not_found -%>
<%       end # if some doc_links -%>
<%     end # each normative rule -%>
|===

<%   else # tags not available -%>
[cols="20%,40%,40%"]
|===
| Name | Description | Documentation Links

<%     db_obj.normative_rules.each do |nr| -%>
| <%= defined?(fmt) ? anchor_for_udb_doc_norm_rule(fmt, nr.name) : "" %><%= nr.name %>
| <%= nr.description %>
<%       if nr.doc_links.empty? -%>
|
<%       else -%>
a|
<%       nr.doc_links.each do |link| -%>
* <%= link.to_adoc %>
<%         end # each link -%>
<%       end # if empty -%>
<%     end # each normative rule -%>
|===

<%   end # tags not available -%>
<% end # unless no normative rules -%>
