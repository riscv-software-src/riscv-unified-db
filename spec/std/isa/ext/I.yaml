# Copyright (c) Qualcomm Technologies, Inc. and/or its subsidiaries.
# SPDX-License-Identifier: BSD-3-Clause-Clear

# yaml-language-server: $schema=../../schemas/ext_schema.json

$schema: "ext_schema.json#"
kind: extension
name: I
type: unprivileged
long_name: Base integer ISA (RV32I or RV64I)
versions:
  - version: "2.1.0"
    state: ratified
    ratification_date: 2019-06
    changes:
      - ratified RVWMO memory model and exclusion of FENCE.I, counters, and CSR instructions that were in previous base ISA
description: |
  Base integer instructions -- TODO

normative_rules:
  - id: norm.basegrp.all.R-type_operands
    description: R-type instruction source and destination operands
    doc_links:
      - norm:basegrp:all:R-type_operands
    coverage_points: [cp_rs1, cp_rs2, cp_rd, cp_rs1_edges]

  #basegrp

  - id: norm.basegrp.all.imm_always_sex
    description: place holder
    doc_links:
      - norm:basegrp:all:imm_always_sex

  - id: norm.basegrp.all.pcreg
    description: All PCREG
    doc_links:
      - norm:basegrp:all:pcreg

  - id: norm.basegrp.rv32.xregwidth
    description: rv32 xregwidth
    doc_links:
      - norm:basegrp:rv32:xregwidth

  - id: norm.basegrp.all:x0eq0
    description: All X0eq0
    doc_links:
      - norm:basegrp:all:x0eq0
    coverage_points: [cp_rs1, cp_rs2, cp_rd]
  - id: norm.basegrp.rv32i_rv64i.other-xregs
    description: RV32i RV64i other xregs
    doc_links:
      - norm:bases:rv32i_rv64i:other-xregs

  #cti and LS

  - id: ext.instgrp.cti_taken.misaligned_exc
    description: cti misaligned execution
    doc_links:
      - norm:instgrp:taken_cti:ia_misaligned_exc

  - id: ext.instgrp.load_store.addr_misaligned_or_access_fault_exc
    description: LS add misaligned or access fault ex
    doc_links:
      - norm:instgrp:load_store:addr_misaligned_or_access_fault_exc

  - id: ext.instgrp.load_store.atomicity_for_aligned
    description: LS Atomoicity for Aligned
    doc_links:
      - norm:instgrp:load_store:atomicity_for_aligned

  - id: ext.instgrp.load_store.big_endian_operation
    description: LS Big Endian Operation
    doc_links:
      - norm:instgrp:load_store:big_endian_operation

  - id: ext.instgrp.load_store.ea
    description: LS EA
    doc_links:
      - norm:instgrp:load_store:ea

  - id: ext.instgrp.load_store.endian_byte_invariant
    description: LS Endian Byte Invariant
    doc_links:
      - norm:instgrp:load_store:endian_byte_invariant

  - id: ext.instgrp.load_store.endian_byte_operation
    description: LS Endian Byte Operation
    doc_links:
      - norm:instgrp:load_store:endian_byte_operation

  - id: ext.instgrp.load_store.little_endian_operation
    description: LS Little Endian Operation
    doc_links:
      - norm:instgrp:load_store:little_endian_operation

  - id: ext.instgrp.load.exc_x0
    description: Load Exc_x0
    doc_links:
      - norm:instgrp:load:exc_x0

  - id: ext.instgrp.load.operation
    description: Load Op
    doc_links:
      - norm:instgrp:load:operation

  - id: ext.instgrp.store.operation
    description: Store Op
    doc_links:
      - norm:instgrp:store:operation


# not included in initial spreadsheet.

  - id: ext.instgrp.cond_branch.no_ia_misaligned_exc_not_taken
    description: No Ia misaligned exc not taken
    doc_links:
      - norm:instgrp:cond_branch:no_ia_misaligned_exc_not_taken

  - id: ext.instgrp.cti.ia_fault_exc_on_target
    description: CTI ia fault exc on target
    doc_links:
      - norm:instgrp:cti:ia_fault_exc_on_target

  - id: ext.instgrp.cti.no_cti_delay_slots
    description: no cti delay slots
    doc_links:
      - norm:instgrp:cti:no_cti_delay_slots

  - id: ext.instgrp.load_store.no_exc_aligned
    description: LS no exc aligned
    doc_links:
      - norm:instgrp:load_store:no_exc_aligned

# params

  - id: norm.param.I.endianness.little_or_big
    description: Param Little or big endian
    doc_links:
      - norm:param:I:endianness:little_or_big

  - id: norm.param.I.misaligned_ldst.contained_or_fatal_trap
    description: misaligned Ldst contained or fatal trap
    doc_links:
      - norm:param:I:misaligned_ldst:contained_or_fatal_trap

  - id: norm.param.I.misaligned_ldst.eei_dependent_behavior
    description: misaligned ldst eei dependent behavior
    doc_links:
      - norm:param:I:misaligned_ldst:eei_dependent_behavior

  - id: norm.param.I.misaligned_ldst.fully_hw_supported
    description: misaligned ldst fully hw supported
    doc_links:
      - norm:param:I:misaligned_ldst:fully_hw_supported

  - id: norm.param.I.misaligned_ldst.fully_hw_supported_or_visible_trap
    description: Misaigned ldst fully hw supported or visible trap
    doc_links:
      - norm:param:I:misaligned_ldst:fully_hw_supported_or_visible_trap

  - id: norm.param.I.misaligned_ldst.hw_or_invisible_trap_func_of_addr
    description: Misaligned ldst hw or invisible trap func of addr
    doc_links:
      - norm:param:I:misaligned_ldst:hw_or_invisible_trap_func_of_addr

  - id: norm.param.I.misaligned_ldst.invisible_trap
    description: Misaligned ldst invisible trap
    doc_links:
      - norm:param:I:misaligned_ldst:invisible_trap

coverage_points:
  - name: cp_asm_count
    bins: 1
    description: Number of times the instruction is executed in the test, must be greater than 0.
  - name: cp_rs1
    bins: 32
    description: The rs1 register number used in the instruction.
  - name: cp_rs2
    bins: 32
    description: The rs2 register number used in the instruction.
  - name: cp_rd
    bins: 32
    description: The rd register number used in the instruction.
  - name: cp_rs1_edges
    bins: 16
    description: Edge values for rs1 (see <<t-integer-edge-definitions>>).
  - name: cp_rs2_edges
    bins: 16
    description: Edge values for rs2 (see <<t-integer-edge-definitions>>).
  - name: cp_imm_edges
    bins: 16
    description: Edge values for 12-bit immediates (see <<t-immediate-edge-definitions>>).
  - name: cr_rs1_imm_edges
    bins: 16*20
    description: Cross-product of rs1 and 12-bit immediate edges (see <<t-immediate-edge-definitions>>).
  - name: cr_rs1_rs2_edges
    bins: 16*16
    description: Cross-product of rs1 and rs2 edges, used for instructions with two source registers.
  - name: cmp_rs1_rs2
    bins: 32
    description: The rs1 and rs2 registers have the same register number.
  - name: cmp_rd_rs1
    bins: 32
    description: The rd register has the same register number as the rs1 register.
  - name: cmp_rd_rs2
    bins: 32
    description: The rd register has the same register number as the rs2 register.
  - name: cmp_rd_rs1_rs2
    bins: 32
    description: The rd register has the same register number as both the rs1 and rs2 registers.
  - name: cp_offset
    bins: 2
    description: A branch or jalr instruction has a positive and negative offset.
  - name: cp_uimm
    bins: XLEN
    description: Exercise all XLEN unsigned immediate values, such as shift amounts.
  - name: cp_align
    bins: â‰¤ 8
    description: Alignment of naturally-aligned sub-doubleword load/store operand within doubleword
  - name: cp_gpr_hazard
    bins: 4
    description: "General-purpose register hazard detection: RAW, WAR, WAW, and no hazard."
